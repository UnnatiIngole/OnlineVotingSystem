package finalmodule;
// Import necessary packages for date/time handling and collections
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.util.*;

/**
 * Represents a candidate in the voting system
 * Stores candidate details and vote count
 */

class Candidate {
    // Basic candidate information
    String candidateId;
    String Name;
    String partyName;
    int Votes;

    // Constructor to initialize candidate details
    public Candidate(String candidateId, String name, String partyName) {
        this.candidateId = candidateId;
        this.Name = name;
        this.partyName = partyName;
        this.Votes = 0;
    }

    // Getter and setter methods
    public String getCandidateId() { 
        return candidateId; 
    }
    public String getName() { 
        return Name; 
    }
    public String getPartyName() { 
        return partyName; 
    }
    public int getVotes() { 
        return Votes; 
    }
    public void setName(String name) { 
      this.Name = name; 
    }
    public void setPartyName(String partyName) { 
         this.partyName = partyName; 
    }
    public void incrementVote() { 
        Votes++; 
    }

    // Returns formatted candidate information for display
    String get_Info() {
         return candidateId + " | " + Name + " | " + partyName + " | Votes: " + Votes;
    }
}

/**
 * Manages all candidate-related operations and voting process
 * Includes registration, voting, and result management
 */
class CandidateManager {
    // Voting status flags
    boolean start_vote = false;    // Indicates if voting has started
    boolean end_Vote = false;      // Indicates if voting has ended
    boolean result_Declare = false; // Indicates if results are declared

    // Data structures for storing information
    HashMap<String, Candidate> candidateMap = new HashMap<>();     // Stores candidate information
    LinkedList<String> auditLog = new LinkedList<>();             // Stores system activity logs
    PriorityQueue<Candidate> Sorted_Results = new PriorityQueue<>((c1, c2) -> c2.Votes - c1.Votes); // For sorting results

    // Method Registers a new candidate
    public boolean registerCandidate(String id, String name, String party) {
        if (id == null || id.isEmpty()) return false;   //returns if id enterend in null
        if (candidateMap.containsKey(id)) return false; //returns if candidate with same id already exists
        //else adds candidate to the map
        candidateMap.put(id, new Candidate(id, name, party)); //adds candidate to the map
        addLog("Candidate registered: " + name + " (" + party + ")"); //logs the registration action
        return true;
    }

    // Method to add a vote to a candidate
    public boolean addVote(String id) {
        Candidate c = candidateMap.get(id); //retrieves candidate from map using id
        if (c == null) {
            System.out.println("Sorry! Candidate not found.");
            return false;
        }
        c.incrementVote();
        addLog("Vote added for candidate: " + c.Name);
        return true;
    }

    // Method to get specific registered candidate information
    public void getCandidate(String id) {
        if (candidateMap.containsKey(id)) {
            Candidate c = candidateMap.get(id);
            System.out.println("=============== Candidate Information ===============");
            System.out.println("Name: " + c.Name);
            System.out.println("ID: " + c.candidateId);
            System.out.println("Party: " + c.partyName);
            System.out.println("Votes: " + c.Votes);
            System.out.println("====================================================");
        } else {
            System.out.println("Candidate with ID " + id + " is not registered.");
        }
    }

    // Method to display all registered candidates
    public void displayAllCandidate() {
        if (candidateMap.isEmpty()) {
            System.out.println("\nNo candidates available.");
            return;
        }
        System.out.println("\n=============== CANDIDATE LIST ===============");
        System.out.println("\nID | Name | Party | Votes");
        System.out.println("----------------------------------------");
        for (Candidate c : candidateMap.values()) {
            System.out.println(c.get_Info());
        }
        System.out.println("\n============================================");
    }

    // Method to remove specific candidate by ID
    public boolean remove_Candidate(String key) {
        if (candidateMap.remove(key) != null) {
            addLog("Candidate removed: " + key);
            System.out.println("Removed successfully.");
            return true;
        }
        System.out.println("Candidate not found.");
        return false;
    }

    // Method to update candidate information
    public void updateCandidate(String id, String newName, String newParty) {
        Candidate c = candidateMap.get(id);
        if (c != null) {
            c.setName(newName);
            c.setPartyName(newParty);
            addLog("Candidate updated: " + id);
            System.out.println("Candidate info updated successfully!");
        } else {
            System.out.println("Candidate not found!");
        }
    }

   // Method to start the voting process
    public boolean startVoting() {
        start_vote = true;
        System.out.println("---Voting Started---");
        addLog("Voting started");
        return true;
    }

    // Method to end the voting process
    public boolean endVoting() {
        end_Vote=true;
        System.out.println("---Voting Ended---");
        addLog("Voting ended");
        return true;
    }

    // Method to declare the election results
    public boolean DeclareResult() {
        result_Declare = true;
        System.out.println("---Result Declared---");
        addLog("Results declared");
        return true;
    }

    // Method to add an entry to the audit log
    public void addLog(String action) {
        LocalDateTime now = LocalDateTime.now();
        DateTimeFormatter format = DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm:ss");
        String logEntry = "[" + now.format(format) + "] " + action;
        auditLog.add(logEntry);
    }

    // Method to display the audit logs
    public void displayLog() {
        if (auditLog.isEmpty()) {
            System.out.println("\nNo logs recorded yet.");
            return;
        }
        System.out.println("\n================== AUDIT LOGS ==================");
        for (String log : auditLog) {
            System.out.println(log);
        }
        System.out.println("================================================\n");
    }
}

/// Manages and displays election results
class Results {
    CandidateManager A1;
    public Results(CandidateManager A1) {
        this.A1 = A1;
    }

    // Adds candidates to the priority queue for sorted results
    public void Add_Results_Sorted() {
        A1.Sorted_Results.clear();
        for (Candidate c : A1.candidateMap.values()) {
            A1.Sorted_Results.add(c);
        }
    }

    // Displays the sorted election results
    public void Display_Results_Sorted() {
        if (A1.result_Declare) {
            Add_Results_Sorted();
            System.out.println("\n============== ELECTION RESULTS ==============");
            System.out.println("\nCandidate Name | Votes");
            System.out.println("----------------------------------------");
            while (!A1.Sorted_Results.isEmpty()) {
                Candidate c = A1.Sorted_Results.poll();
                System.out.printf("%-15s | %d votes\n", c.Name, c.Votes);
            }
            System.out.println("\n============================================");
        } else {
            System.out.println("\n|||| Results are not announced yet ||||\n");
        }
    }

    /**
     * Displays the top three candidates based on votes
     */
    public void top_three_Results() {
        if (A1.result_Declare) {
            Add_Results_Sorted();
            System.out.println("\n=========== TOP THREE CANDIDATES ===========");
            System.out.println("\nRank | Name | Votes");
            System.out.println("----------------------------------------");
            int count = 0;
            while (!A1.Sorted_Results.isEmpty() && count < 3) {
                Candidate c = A1.Sorted_Results.poll();
                System.out.printf(" %d   | %-15s | %d votes\n", ++count, c.Name, c.Votes);
            }
            System.out.println("\n============================================");
        } else {
            System.out.println("\n|||| Results are not announced yet ||||\n");
        }
    }
}

/// User Defined data-type for voter
class Voter {
        String voterId;
        String password;
        String name;
        int age;
        String gender;
        String contactNumber;
        String district;
        String state;
        boolean aadhaarPresent;

    // Constructor to initialize voter details
    public Voter(String voterId, String password, String name, int age, String gender, String contactNumber,
    String district, String state, boolean aadhaarPresent) {
        this.voterId = voterId;
        this.password = password;
        this.name = name;
        this.age = age;
        this.gender = gender;
        this.contactNumber = contactNumber;
        this.district = district;
        this.state = state;
        this.aadhaarPresent = aadhaarPresent;
    }
}

/**
 * Manages voter registration and authentication
 * Includes voter database and voting operations
 */
class RegisterVoter {
    // Static HashMap to store all registered voters
    static HashMap<String, Voter> voters = new HashMap<>();
    boolean start = false;

    // Loads initial voter data into the system
    void loadInitialData() {
        voters.put("V101", new Voter("V101", "pass1Aa", "Riya Sharma", 25, "Female", "9876543210", "Mumbai", "Maharashtra", true));
        voters.put("V102", new Voter("V102", "pass2Aa", "Arjun Kumar", 32, "Male", "9812345678", "New Delhi", "Delhi", true));
        voters.put("V103", new Voter("V103", "pass3Aa", "Saanvi Patel", 19, "Female", "9001122334", "Bengaluru", "Karnataka", true));
        voters.put("V104", new Voter("V104", "pass4Aa", "Rahul Singh", 29, "Male", "9123456780", "Lucknow", "Uttar Pradesh", true));
        voters.put("V105", new Voter("V105", "pass5Aa", "Ananya Roy", 22, "Female", "9988776655", "Kolkata", "West Bengal", true));
        voters.put("V106", new Voter("V106", "pass6Aa", "Karan Mehta", 31, "Male", "9090909090", "Ahmedabad", "Gujarat", true));
        voters.put("V107", new Voter("V107", "pass7Aa", "Sneha Iyer", 27, "Female", "9191919191", "Chennai", "Tamil Nadu", true));
        voters.put("V108", new Voter("V108", "pass8Aa", "Vikram Singh", 35, "Male", "9222223333", "Pune", "Maharashtra", true));
    }

    /**
     * Handles new voter registration process
     * Validates and stores voter information
     */
    void registerNewVoter(Scanner sc) {
        if (!start) {
            loadInitialData();
            start = true;
        }
        sc.nextLine(); // clear buffer

       System.out.println("\n=== NEW VOTER REGISTRATION ===");

        //Accepting Voter Id
        String voterId;
        while (true) {
            //Assuming Voter Id to be 4 digit alphanumeric
            System.out.print("Enter Your Voter ID (e.g., V104):");
            voterId = sc.nextLine().trim();
            if (voterId.isEmpty()) {
                System.out.println("Voter ID cannot be empty. Try again.");
                continue;
            }
            if (voters.containsKey(voterId)) {
                System.out.println("This voter ID already exists! Please choose a different ID.");
                continue;
            }
            break;
        }
        //Accepting Voter Name
        String name;
        while (true) {
            System.out.print("Enter Full Name: ");
            name = sc.nextLine().trim();
            if (name.isEmpty() || !name.matches("[a-zA-Z\\s]+")) {
                System.out.println("Please enter a valid name (letters and spaces only).");
            } else {
                break;
            }
        }
        // Accept Age
        int age;
        while (true) {
            System.out.print("Enter Age: ");
            String ageInput = sc.nextLine().trim();
            try {
                age = Integer.parseInt(ageInput);
                break;
            } catch (NumberFormatException e) {
                System.out.println("Please enter a valid number for age.");
            }
        }
        // Check if voter is eligible or not
        if (age < 18 || age > 105) {
            System.out.println("You must be at least 18 years old and not older than 105 years to register!");
            return;
        }
        // Accepting gender
        String gender;
        while(true){
            System.out.print("Enter Gender (Male/Female/Other): ");
            gender = sc.nextLine().trim();
            if (gender.equalsIgnoreCase("Male") || gender.equalsIgnoreCase("Female") || gender.equalsIgnoreCase("Other")) {
                break;
            } else {
                System.out.println("Invalid input. Please enter Male, Female, or Other.");
            }
        }
        //Accepting Contact Number
        String contactNumber;
        while(true){
            System.out.print("Enter Contact Number: ");
            contactNumber = sc.nextLine().trim();
            if (contactNumber.matches("\\d{10}")) {
                break;
            } else {
                System.out.println("Please enter a valid 10-digit contact number.");
            }
        }
        //Accepting input for district
        String district;
        while(true){
            System.out.print("Enter District: ");
            district = sc.nextLine().trim();
            if (district.isEmpty()) {
                System.out.println("District cannot be empty. Try again.");
            } else {
                break;
            }
        }

        //Accepting input for state
        String state;
        while(true){
            System.out.print("Enter State: ");
            state = sc.nextLine().trim();
            if (state.isEmpty()) {
                System.out.println("State cannot be empty. Try again.");
            } else {
                break;
            }
        }

        // Check whether Voter has Aadhaar card
        boolean hasAadhaar;
        while(true) {
            System.out.print("Do you have an Aadhaar card? (y/n): ");
            String input = sc.nextLine().trim().toLowerCase();
            
            if (input.equals("y") || input.equals("yes")) {
                hasAadhaar = true;
                break;
            } else if (input.equals("n") || input.equals("no")) {
                System.out.println("You must have an Aadhaar card to register online.");
                return;
            } else {
                System.out.println("Invalid input. Please enter 'y' for Yes or 'n' for No.");
            }
        }
       
       //Enter Password
       String password;
       System.out.println("Set your account password:");
       System.out.println("\nNOTE: Password must use 6+ characters, with a capital letter, number, —no spaces.\n");
        while (true) {
            System.out.print("Enter your password: ");
            password = sc.nextLine();

            if (isValidPassword(password)) {
                System.out.println("Password is valid!");
                break;
            } else {
                System.out.println(" Invalid password. Try again.");
                System.out.println("Rules:6+ characters, 1 uppercase, 1 number, 1 symbol, no spaces.\n");
            }
        }

        // Create new Voter object and add it to HashMap
        Voter newVoter = new Voter(voterId, password, name, age, gender, contactNumber, district, state,hasAadhaar);
        voters.put(voterId, newVoter);

        System.out.println("\nRegistration successful for " + name + "! Your Voter ID: " + voterId);

    }

    //Password validation method
     public static boolean isValidPassword(String password) {
        return password.length() >= 6 &&
                password.matches(".*[A-Z].*") &&    // at least one uppercase
                password.matches(".*\\d.*") &&      // at least one digit
                !password.contains(" ");
    }

    //Method to handle voter login
    boolean loginVoter(Scanner sc) {
        sc.nextLine(); // clear buffer

        System.out.println("\n=== VOTER LOGIN ===");
        String voterId;
        while (true) {
            //Assuming Voter Id to be 4 digit alphanumeric
            System.out.print("Enter Your Voter ID (e.g., V104):");
            voterId = sc.nextLine().trim();
            if (voterId.isEmpty()) {
                System.out.println("Voter ID cannot be empty. Try again.");
            }else{
               if (!voters.containsKey(voterId)) {
                 System.out.println("No voter found with this ID. Please register first.");
                 return false;
               } 
               break;
            }    
        }

        //Creating Voter object for the entered voterId
        Voter v = voters.get(voterId);
        String password;
        while (true) {
            System.out.print("Enter your password: ");
            password = sc.nextLine();

            if (isValidPassword(password) && password.equals(v.password)) {
                break; // Successful login
            } else {
                System.out.println(" Invalid password. Try again.");
                System.out.println("Rules: 6+ characters, 1 uppercase, 1 number, 1 symbol, no spaces.\n");
            }
        }
        System.out.println("Login successful !!! Welcome, " + v.name + "!");
        return true;
    }

    //Method to handle vote casting
    void castVote(Scanner sc, CandidateManager C1) {
        if (C1.start_vote && !C1.end_Vote) {
            sc.nextLine(); // clear buffer
            C1.displayAllCandidate();
            System.out.println("Please Enter Candidate ID to Cast Your Vote:");
            String vote_id = sc.nextLine();
            if (C1.addVote(vote_id) && C1.candidateMap.containsKey(vote_id)) {
                System.out.println("###### Successfully Voted ######");
            } else {
                System.out.println("###### Voting Failed ######");
                System.out.println("Please Try Again Later ... !");
            }
        } else if (C1.end_Vote) {
            System.out.println("Voting period is over!");
        } else {
            System.out.println("Voting has not started yet!");
        }
    }
}

// Main class to run the voting system
public class Main {
    public static void main(String[] args) {
        // Initialize scanner and system components
        Scanner S1 = new Scanner(System.in);
        CandidateManager admin = new CandidateManager();
        RegisterVoter voter = new RegisterVoter();
        Results R1 = new Results(admin);

        // Main program loop
        int y;
        do {
            // Display main menu
            System.out.println("\n================================================");
            System.out.println("            ONLINE VOTING SYSTEM");
            System.out.println("================================================");
            System.out.println("\n1. VOTER");
            System.out.println("2. ADMIN");
            System.out.println("3. CANDIDATE");
            System.out.println("4. RESULTS");
            System.out.println("\nEnter choice: ");
            int n;
            while(true){
                if(S1.hasNextInt()){
                    n = S1.nextInt();
                    if(n>=1 && n<=4){ 
                        break;
                    }
                    else{
                        System.out.println("Invalid input. Please enter a number between 1 and 4.");
                    }
                    
                }else{
                    System.out.println("Invalid input. Please enter a number.");
                    S1.next(); // Clear invalid input
                }
            }

            switch (n) {
                case 1 -> {// Voter Menu
                    int k;
                    do {
                        System.out.println("--- VOTER MENU ---");
                        System.out.println("1. Register Voter");
                        System.out.println("2. Login Voter");
                        System.out.println("3. Back to Main Menu");
                        System.out.print("Enter choice: ");
                        int V_choice ;
                        while(true){
                            if(S1.hasNextInt()){
                                V_choice = S1.nextInt();
                                if(V_choice>=1 && V_choice<=3){ 
                                    break;
                                }
                                else{
                                    System.out.println("Invalid input. Please enter a number between 1 and 3.");
                                }
                            }else{
                                System.out.println("Invalid input. Please enter a number.");
                                S1.next(); // Clear invalid input
                            }
                        }

                        switch (V_choice) {
                            case 1 -> voter.registerNewVoter(S1); // Register new voter
                            case 2 -> {// Voter login
                               if (voter.loginVoter(S1)) {
                                   int LV;
                                   do {
                                       System.out.println("--- VOTING MENU ---");
                                       System.out.println("1. Cast Vote");
                                       System.out.println("2. Exit Voting Menu");
                                       System.out.print("Enter choice: ");
                                       int LV_choice;
                                        while(true){
                                             if(S1.hasNextInt()){
                                                  LV_choice = S1.nextInt();
                                                  if(LV_choice>=1 && LV_choice<=2){ 
                                                    break;
                                                  }
                                                  else{
                                                    System.out.println("Invalid input. Please enter a number between 1 and 2.");
                                                  }
                                             }else{
                                                  System.out.println("Invalid input. Please enter a number.");
                                                  S1.next(); // Clear invalid input
                                             }
                                        }
                                       if (LV_choice == 1) {
                                           voter.castVote(S1, admin);
                                       } else if (LV_choice == 2) {
                                           break;
                                       }
                                       System.out.print("Continue Logged In? (1=Yes/0=No): ");
                                       while(true){
                                            if(S1.hasNextInt()){
                                                LV = S1.nextInt();
                                                if(LV==0 || LV==1){ 
                                                    break;
                                                }
                                                else{
                                                    System.out.println("Invalid input. Please enter 1 for Yes or 0 for No.");
                                                }
                                            }else{
                                                System.out.println("Invalid input. Please enter a number.");
                                                S1.next(); // Clear invalid input
                                            }
                                       }
                                   } while (LV == 1);
                               }
                            }
                            case 3 -> System.out.println("Returning to Main Menu...");
                            default -> System.out.println("Invalid choice!");
                        }
                        System.out.print("Continue as Voter? (1=Yes/0=No): ");
                        while(true){
                            if(S1.hasNextInt()){
                                k = S1.nextInt();
                                if(k==0 || k==1){ 
                                    break;
                                }
                                else{
                                    System.out.println("Invalid input. Please enter 1 for Yes or 0 for No.");
                                }
                            }else{
                                System.out.println("Invalid input. Please enter a number.");
                                S1.next(); // Clear invalid input
                            }
                        }
                    } while (k == 1);
                }

                case 2 -> { /// Admin Menu
                	// ✅ ADMIN LOGIN ADDED HERE
                    System.out.println("\n=== ADMIN LOGIN ===\n");
                    S1.nextLine();
                    System.out.print("Enter Username: ");
                    String user = S1.nextLine().trim();
                    System.out.print("Enter Password: ");
                    String pass = S1.nextLine().trim();

                    if (user.equals("admin") && pass.equals("admin123")) {
                        System.out.println("\n✅ Login successful! Welcome Admin.\n");


                    int ad=0;
                    do{
                        System.out.println("--- ADMIN MENU ---");
                        System.out.println("1. Add Candidate");
                        System.out.println("2. View All Candidates");
                        System.out.println("3. Update Candidate");
                        System.out.println("4. Remove Candidate");
                        System.out.println("5. Start Voting");
                        System.out.println("6. Stop Voting");
                        System.out.println("7. Declare Result");
                        System.out.println("8. View Audit Log");
                        System.out.print("Enter choice: ");
                        int choice ;
                        while(true){
                            if(S1.hasNextInt()){
                                choice = S1.nextInt();
                                if(choice>=1 && choice<=8){ 
                                    break;
                                }
                                else{
                                    System.out.println("Invalid input. Please enter a number between 1 and 8.");
                                }
                            }else{
                                System.out.println("Invalid input. Please enter a number.");
                                S1.next(); // Clear invalid input
                            }
                        }
                        S1.nextLine();
                        switch (choice) {
                            case 1 -> { // Add Candidate
                                System.out.print("How many candidates to add? ");
                                int no;
                                while(true){
                                    if(S1.hasNextInt()){
                                        no = S1.nextInt();
                                        if(no>0 && no<=60){ 
                                            break;
                                        }
                                        else{
                                            System.out.println("Invalid input. You can only Input in Range (1-60).");
                                        }
                                    }else{
                                        System.out.println("Invalid input. Please enter a number.");
                                        S1.next(); // Clear invalid input
                                    }
                                }

                                S1.nextLine();
                                for (int i = 0; i < no; i++) {
                                   System.out.println("\nEnter details for candidate " + (i + 1));
                                   System.out.print("Candidate ID: ");
                                   String cId;
                                      while (true) {
                                          cId = S1.nextLine().trim();
                                          if (cId.isEmpty()) {
                                              System.out.println("Candidate ID cannot be empty. Try again.");
                                          } else if (admin.candidateMap.containsKey(cId)) {
                                              System.out.println("This Candidate ID already exists! Please choose a different ID.");
                                          } else {
                                              break;
                                          }
                                      }
                                   System.out.print("Candidate Name: ");
                                   String cName;
                                      while (true) {
                                        cName = S1.nextLine().trim();
                                        if (cName.isEmpty() || !cName.matches("[a-zA-Z\\s]+")) {
                                             System.out.println("Please enter a valid name (letters and spaces only).");
                                        } else {
                                             break;
                                        }
                                      }
                                   System.out.print("Party Name: ");
                                   String pName;
                                      while (true) {
                                         pName = S1.nextLine().trim();
                                         if (pName.isEmpty() || !pName.matches("[a-zA-Z\\s]+")) {
                                                System.out.println("Please enter a valid party name (letters and spaces only).");
                                         } else {
                                                break;
                                         }
                                      }
                                   admin.registerCandidate(cId, cName, pName);
                                }
                            }

                            case 2 -> admin.displayAllCandidate(); // View All Candidates
                        
                            case 3 -> {// Update Candidate  -- If Party wish to change the candidate representing their Party
                                System.out.print("Enter Candidate ID to update: ");
                                String updateId;
                                   while (true) {
                                       updateId = S1.nextLine().trim();
                                       if (updateId.isEmpty()) {
                                           System.out.println("Candidate ID cannot be empty. Try again.");
                                       } else if (!admin.candidateMap.containsKey(updateId)) {
                                           System.out.println("No candidate found with this ID. Please enter a valid ID.");
                                       } else {
                                           break;
                                       }
                                   }
                                System.out.print("Enter new Name: ");
                                String newName;
                                   while (true) {
                                       newName = S1.nextLine().trim();
                                       if (newName.isEmpty() || !newName.matches("[a-zA-Z\\s]+")) {
                                           System.out.println("Please enter a valid name (letters and spaces only).");
                                       } else {
                                           break;
                                       }
                                   }
                                System.out.print("Enter new Party Name: ");
                                String newParty;
                                   while (true) {
                                       newParty = S1.nextLine().trim();
                                       if (newParty.isEmpty() || !newParty.matches("[a-zA-Z\\s]+")) {
                                           System.out.println("Please enter a valid party name (letters and spaces only).");
                                       } else {
                                           break;
                                       }
                                   }
                                admin.updateCandidate(updateId, newName, newParty);
                            }

                            case 4 -> {// Remove Candidate
                                System.out.print("Enter Candidate ID to Remove: ");
                                String delId;
                                   while (true) {
                                       delId = S1.nextLine().trim();
                                       if (delId.isEmpty()) {
                                           System.out.println("Candidate ID cannot be empty. Try again.");
                                       } else if (!admin.candidateMap.containsKey(delId)) {
                                           System.out.println("No candidate found with this ID. Please enter a valid ID.");
                                       } else {
                                           break;
                                       }
                                   }
                                admin.remove_Candidate(delId);
                            }

                            case 5 -> admin.startVoting();// Start Voting

                            case 6 -> admin.endVoting();// Stop Voting

                            case 7 -> admin.DeclareResult();// Declare Result

                            case 8 -> admin.displayLog();// View Audit Log

                            default -> System.out.println("Invalid choice!");
                        }
                       
                        while(true){
                            System.out.println("Continue as Admin(Yes=1/No=0)");
                            if(S1.hasNextInt()){
                                ad = S1.nextInt();
                                if(ad==0 || ad==1){ 
                                    break;
                                }
                                else{
                                    System.out.println("Invalid input. Please enter 1 for Yes or 0 for No.");
                                }
                            }else{
                                System.out.println("Invalid input. Please enter a number.");
                                S1.next(); // Clear invalid input
                            }
                        }
                    }
                    while(ad==1);}
                    else {
                    	System.out.println("Please enter valid username or password"); 
                    	}
                }

                case 3 -> {// Candidate Menu
                    System.out.println("--- CANDIDATE MENU ---");
                    System.out.println("1. View Candidate Profile");
                    System.out.println("2. View All Candidates");
                    System.out.print("Enter choice: ");
                    int C_choice;
                       while(true){
                           if(S1.hasNextInt()){
                               C_choice = S1.nextInt();
                               if(C_choice>=1 && C_choice<=2){ 
                                   break;
                               }
                               else{
                                   System.out.println("Invalid input. Please enter a number between 1 and 2.");
                               }
                           }else{
                               System.out.println("Invalid input. Please enter a number.");
                               S1.next(); // Clear invalid input
                           }
                       }
                    S1.nextLine();
                    switch (C_choice) {
                        case 1 -> {
                            System.out.print("Enter your Candidate ID: ");
                            String cId;
                            while (true) {
                                cId = S1.nextLine().trim();
                                if (cId.isEmpty()) {
                                    System.out.println("Candidate ID cannot be empty. Try again.");
                                } else if (!admin.candidateMap.containsKey(cId)) {
                                    System.out.println("No candidate found with this ID. Please enter a valid ID.");
                                } else {
                                    break;
                                }
                            }
                            admin.getCandidate(cId);
                        }
                        case 2 -> admin.displayAllCandidate(); // View All Candidates
                        
                        default -> System.out.println("Invalid choice!");
                    }
                }
                case 4 -> {
                    System.out.println("--- RESULTS MENU ---");
                    System.out.println("1. View Sorted Results");
                    System.out.println("2. View Top 3 Candidates");
                    System.out.print("Enter choice: ");
                    int R_choice;
                    while (true) {
                        if (S1.hasNextInt()) {
                            R_choice = S1.nextInt();
                            if (R_choice >= 1 && R_choice <= 2) {
                                break;
                            } else {
                                System.out.println("Invalid input. Please enter a number between 1 and 2.");
                            }
                        } else {
                            System.out.println("Invalid input. Please enter a number.");
                            S1.next(); // Clear invalid input
                        }
                    }
                    switch (R_choice) {
                        case 1 -> R1.Display_Results_Sorted(); // View All Sorted Results
                        case 2 -> R1.top_three_Results(); // View Top 3 Candidates
                        default -> System.out.println("Invalid choice!");
                    }
                }
                default -> System.out.println("Invalid main menu choice!");
            }
            System.out.print("Do you want to Continue(main Menu)? (1=Yes/0=No): ");
            while(true){
                if(S1.hasNextInt()){
                    y = S1.nextInt();
                    if(y==0 || y==1){ 
                        break;
                    }
                    else{
                        System.out.println("Invalid input. Please enter 1 for Yes or 0 for No.");
                    }
                }else{
                    System.out.println("Invalid input. Please enter a number.");
                    S1.next(); // Clear invalid input
                }
            }
        } while (y==1);}
}
